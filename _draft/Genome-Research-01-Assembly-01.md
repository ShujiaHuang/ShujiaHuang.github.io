---
layout: post
title: '基因组研究系列（一）：基因组组装（上）'
categories:
    - 生物信息
    - 基因组学
tags:
    - 基因组组装
---

在evernote的“测序与组装相关”的笔记本下。

<a id='introduce' name='introduce'> </a>

### 前言
----

之所以写这个，是因为我打算写一个关于人类基因组学研究的一系列文章，算作是对过去这几年的一个小结，鉴于我自己的认识有限，我不敢说这会是最前沿的，但应该可以是当前基因组学研究的主流方法和成果。

### 概述
----

基因组组装是基因组学研究中的一个非常重要，同时也非常复杂的问题，它的复杂性主要源自于不同物种自身基因组序列特征的复杂性，比如有些植物和海洋生物他们有着巨复杂的基因组，复杂到以目前的技术手段还解决不了，像这方面的例子有[...]()。另外一个重要的因素是基因组组装所消耗的计算资源相当巨大，按照目前做的比较好的一些组装软件，如SOAPdenovo，AllPathLG，它们消耗的计算机内存资源约为物种基因组大小的100倍到150倍。我本来只想用一个篇幅的文章来概述一下基因组组装技术，但是写着写着就发现这个过程实在复杂。所以，最终只能砍成3篇了。

* （上）[]()
* （中）[]()
* （下）[]()

OK，以下进入正题。

### 什么是基因组组装，为什么要进行基因组组装
----

但在开始之前我有必要先说明一下什么是基因组组装（也可称为基因组序列构建）以及为什么要进行基因组组装这两个问题。

基因组组装就是将通过测序仪测得的物种DNA序列片段正确组合成属于该物种的一个基因组。这样说可能有点抽象，举个具体点的例子，就是把汽车厂生产出来的一堆零件组合成一辆汽车。这里测序仪就是汽车厂，测得的DNA片段就是各个的零件，这个汽车组合的过程就是组装。

你或许会疑惑，难道测序仪测出来的每条完整DNA序列不应该就是直接是物种完完整整的DNA序列了吗，怎么还会需要组装呢？第一，对于真核生物而言绝大部分的DNA都存在于细胞核之中，要检测它就必须击破细胞，将藏在核中的DNA抽取出来，这是一个破坏的过程，再加上实际操作中的其他物理损伤，基本上就已无法保证DNA的完整性了（对原核生物来讲也一样）；第二，来自于测序技术本身的限制，当前还没有一种测序技术能够真正做到将物种的DNA**一次性！连续！完整！**地测出来，关于这一点以下我还会再次提到。这两点是为什么需要基因组组装的根本原因。组装的必要性和的目自是不必多说，对于还没有测序过的物种来说更是重中之重，不管是人还是其他物种，所有重要的遗传信息都在它的DNA上，获得其尽可能完整的DNA序列，是进行所有下游注释，比较，进化，（人）健康特征，（人）药物反应等等各类分析与研究的重要前提。一言以蔽之，要更好的理解一个物种，就需要获得其更完整的DNA序列，因此我们需要对它的基因组测序片段进行组装。

俗话说：“巧妇难为无米之炊”，组装之前需先测序。基因组测序是基因组学研究的一个核心手段，这几年来，确切来说是自2007年以来短测序技术的发展速度非常快——关于测序技术的原理和发展历程我在去年[三代基因组测序技术原理简介](/2013/08/02/An-Introduction-of-NGS-Sequence.html)中已作了比较详细的描述，这里就不再赘述。总的说来，基因组测序技术已从传统的Sanger法发展到现在成熟的第二代边合成边测序，并且也已步入第三代的单分子测序技术领域。

测序的成本也在快速转入白菜价，如今年初illumina就宣称测序成本已经进入1000刀（尽管它的计算方式完全是一个理想情形的计算），测序通量更是节节高。但序列读长Sanger法的800bp左右，降到到现在第二代高通量的100bp，150bp读长的序列（以illumina为代表），考虑到目前第三代测序技术错误率偏高，应用也仍不普遍，这里暂不讨论与第三代测序技术相关的组装问题。

就组装而言序列读长是一个非常重要的因素，每一次测序技术革新中序列读长的变化都会显著影响基因组组装技术的具体发展。传统的Sanger测序法中，由于测序的序列读长比较长，可以通过测序片段之间的重叠来确定测序片段的位置，最终组装出基因组，这便是早期基于overlap-layout-consensus的组装方法，也是“人类基因组计划”中主要使用的方法。但在当前的第二代高通量测序读长远小于Sanger法，原始的overlap-layout-consensus方法不再适用于这些短序列测序数据的组装，而是以基于*de* Bruijn Graph的图论方法来解决这些短测序读长的基因组组装。或许你会觉得不同的测序方法就得需要一个不同的组装技术是一个麻烦的事情，但其实万变不离其宗，归根到底它们都是一个数学问题，所以接下来我将先从组装的数学原理和计算机算法实现这两大方面对基因组组装进行详细的讲解，限于篇幅，这一篇先讲解组装的数学原理。

（组装容易吗？为什么难，计算资源，内存，基因组的序列复杂情况）

### 基因组组装的数学原理
----
刚才在上面也稍微提到了—— 组装本质上是一个数学问题，我们可以利用数学的方法来直接揭示组装，清晰的告诉我们什么是该做的什么是不必做的，以及该如何去做，而且得到的结论在处理组装问题的过程中是普适的，并不会因为测序读长发生变化，它就不适用了。所以在进一步理解组装技术之前，先搞明白它的数学原理是很有意义的，当然任何理论都有其适用的前提条件，接下来我也都会在下文中提到。

Lander-Waterman模型是基因组组装的一个基本数学模型，它，
这个模型从数学的角度对基因组组装进行了分析，对组装的结果进行预测，从中我们可以对影响组装结果的各个因素进行分析。


### 基因组组装的算法

### 基因组组装的一般流程
（0）如何调查基因组的大小(如何利用kmer估算基因组的大小)
（1）数据过滤
（2）kmer 频率分析
	1）什么是kmer，为什么kmer只能是奇数
	2）
（3）k-mer纠错的算法
（4）组装的kmer是什么
（4）pregraph
（5）contig
（6）scaffolding
（7）Gap fill
### （短序列）组装的困难之处
#### 什么是Tips，Bubble，他们是如何形成的
#### Repeat序列组装的难点，以及为什么他们是难点，如何处理。 
### 如何评估组装结果
### 组装软件比较
### 组装的应用
### 最后

